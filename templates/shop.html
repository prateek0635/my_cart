{% extends 'base.html' %}

{% block body %}
{% if messages %}
{% for message in messages %}
<div class="alert alert-warning alert-dismissible fade show" role="alert">

  {{ message }}
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endfor %}
{% endif %}

{% if not request.user.is_anonymous %}
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary mx-2" data-toggle="modal" data-target="#exampleModalLong">
  <i class="fas fa-shopping-cart"></i> <span class="badge badge-light">{{count}}</span>
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Cart of {{shop.shop_name}} </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        {% for item in cart  %}
        <div class="card my-2">
          <div class="row">
            <img style="width:50px;height:50px;" src="/{{item.products.prod_img}}" alt="..." class="rounded-circle">
            <div class="col">
              <h6 class="card-title mx-5"><b>{{item.products.prod_name}}</b></h6>
              <div class="row">
                <p class="my-2 mx-5" style="color:red;">Rs.{{item.products.prod_price}}/-</p>
                <h8 class='mx-2'><b> Quantity:</b>{{item.quantity}}</h8>
                <a href="/addtocart/{{item.id}}/delete/" class="btn btn-outline-danger">Remove</a>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <form action="/order/{{shop.id}}">
          <button type="submit" class="btn btn-primary">Place Order</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endif %}

<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <div class="row">
      <img style="width:150px;height:150px;"src="/{{shop.shop_pic}}" alt="..." class="rounded">
      <div class="col">
        <h1 class="display-4">{{shop.shop_name}}</h1>
        <p class="lead">{{shop.shop_add}}</p>
        <a class="btn btn-outline-success" href="https://api.WhatsApp.com/send?phone={{shop.contact}}" role="button"><i class="fab fa-whatsapp"></i></a>
      </div>
    </div>
  </div>
</div>
{% if owner %}
<div class='row mx-2 my-2'>
  <a href='addprod/{{shop.id}}'>
    <button type="button" class="btn btn-secondary mx-2">+ Add prod</button></a>

  <form action="/productupdate/{{shop.id}}">
    <button type="submit" class="btn btn-secondary mx-2">GO to Update Page</button>
  </form>
  <a href="/orders/{{shop.id}}" class="btn btn-outline-danger">Orders</a>
</div>


{% endif %}

<div class="row mx-2">
  {% for i in prod %}
  <div class="card mx-2 text-center" style="width: 18rem;height:20rem;">
    <img style="width:200px;height:150px;" src="/{{i.prod_img}}" class="card-img-top mx-5" alt="...">
    <div class="card-body">
      <h5 class="card-title">{{i.prod_name}}</h5>
      <p class="my-2" style="color:red;">Rs.{{i.prod_price}}/-</p>
      <p class="card-text my-2">{{i.prod_disc}}.</p>
      <div class='row'>
        <a href="/{{i.prod_img}}" class="btn btn-primary mx-2">Watch</a>
        <form action="/addtocart/{{i.id}}/add/" method="POST">{% csrf_token %}
          <input class="mx-2" type="number" value="1" id="quantity" name="quantity" min="1" max="10">
          <button class="btn btn-primary" type="submit">Add</button>
        </form>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock body %}